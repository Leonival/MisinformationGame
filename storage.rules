rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    match /Studies/{study}/{image} {
      allow read: if get(/databases/$(database)/documents/Studies/$(study)).data.enabled
                     || (request.auth != null
                         && request.auth.uid == get(/databases/$(database)/documents/Studies/$(study)).data.authorID);

      allow write: if request.auth != null
                      && request.auth.uid == get(/databases/$(database)/documents/Studies/$(study)).data.authorID;
    }
  }
}
